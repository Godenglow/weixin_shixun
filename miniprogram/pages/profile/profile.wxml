<view class="container" style="background-color: {{colors.bgColor}};">
  <view class="profile-header" style="background-color: {{colors.cardBg}};">
    <view class="user-info">
      <view class="avatar-container" bindtap="chooseAvatar">
        <image class="avatar" src="{{userInfo.avatarUrl || userInfo.cloudId ? userInfo.avatarUrl : ''}}" wx:if="{{userInfo.avatarUrl || userInfo.cloudId}}" mode="aspectFill"></image>
        <view class="avatar-placeholder" wx:else>
          <text class="avatar-icon">ğŸ‘¤</text>
        </view>
      </view>
      <view class="info-text" wx:if="{{userInfo.nickName}}">
        <text class="nickname" style="color: {{colors.textMain}};">{{userInfo.nickName}}</text>
        <view class="level-badge">
          <text>Lv.{{userProfile.level || 1}}</text>
        </view>
      </view>
      <view class="info-text" wx:else>
        <button class="login-btn" bindtap="login">ç‚¹å‡»ç™»å½•</button>
        <button class="auth-btn" bindtap="getUserProfile">æˆæƒå¾®ä¿¡ä¿¡æ¯</button>
      </view>
    </view>
    <view class="stats-row">
      <view class="stat-item">
        <text class="stat-num">{{userProfile.testCount || 0}}</text>
        <text class="stat-label" style="color: {{colors.textSec}};">æµ‹è¯•</text>
      </view>
      <view class="stat-item">
        <text class="stat-num">{{userProfile.points || 0}}</text>
        <text class="stat-label" style="color: {{colors.textSec}};">ç§¯åˆ†</text>
      </view>
      <view class="stat-item">
        <text class="stat-num">{{userProfile.level || 1}}</text>
        <text class="stat-label" style="color: {{colors.textSec}};">ç­‰çº§</text>
      </view>
    </view>
    <view class="level-progress" wx:if="{{userProfile.level}}">
      <view class="progress-info">
        <text style="color: {{colors.textSec}};">Lv.{{userProfile.level}}</text>
        <text style="color: {{colors.textSec}};">Lv.{{(userProfile.level || 1) + 1}}</text>
      </view>
      <view class="progress-bar">
        <view class="progress-fill" style="width: {{userProfile.progress || 0}}%;"></view>
      </view>
      <text class="progress-text" style="color: {{colors.textSec}};">{{userProfile.nextLevelPoints - (userProfile.points || 0)}}ç§¯åˆ†å‡çº§</text>
    </view>
  </view>

  <view class="menu-section" style="background-color: {{colors.cardBg}};">
    <view class="menu-item" bindtap="goToHistory">
      <view class="menu-left">
        <text class="menu-icon">ğŸ“‹</text>
        <text class="menu-text" style="color: {{colors.textMain}};">æµ‹è¯•è®°å½•</text>
      </view>
      <text class="menu-arrow">></text>
    </view>
    <view class="menu-item" bindtap="goToReports">
      <view class="menu-left">
        <text class="menu-icon">ğŸ“Š</text>
        <text class="menu-text" style="color: {{colors.textMain}};">æˆ‘çš„æŠ¥å‘Š</text>
      </view>
      <text class="menu-arrow">></text>
    </view>
    <view class="menu-item" bindtap="goToFavorites">
      <view class="menu-left">
        <text class="menu-icon">â­</text>
        <text class="menu-text" style="color: {{colors.textMain}};">æˆ‘çš„æ”¶è—</text>
      </view>
      <text class="menu-arrow">></text>
    </view>
  </view>

  <view class="menu-section" style="background-color: {{colors.cardBg}};">
    <view class="menu-item" bindtap="toggleTheme">
      <view class="menu-left">
        <text class="menu-icon">ğŸŒ™</text>
        <text class="menu-text" style="color: {{colors.textMain}};">{{isDarkMode ? 'æµ…è‰²æ¨¡å¼' : 'æ·±è‰²æ¨¡å¼'}}</text>
      </view>
      <view class="toggle-switch {{isDarkMode ? 'active' : ''}}">
        <view class="toggle-knob"></view>
      </view>
    </view>
    <view class="menu-item" bindtap="goToAbout">
      <view class="menu-left">
        <text class="menu-icon">â„¹ï¸</text>
        <text class="menu-text" style="color: {{colors.textMain}};">å…³äºæˆ‘ä»¬</text>
      </view>
      <text class="menu-arrow">></text>
    </view>
    <view class="menu-item" bindtap="goToFeedback">
      <view class="menu-left">
        <text class="menu-icon">ğŸ’¬</text>
        <text class="menu-text" style="color: {{colors.textMain}};">æ„è§åé¦ˆ</text>
      </view>
      <text class="menu-arrow">></text>
    </view>
  </view>
</view>
